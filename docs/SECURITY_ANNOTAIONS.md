>
| **Annotation**              | **Step in Method Lifecycle** | **Action Taken**                                            |
| --------------------------- | ---------------------------- | ----------------------------------------------------------- |
| `@PreAuthorize`             | üïì Before method call        | Evaluates expression ‚Üí if false ‚Üí denies access immediately |
| `@PreFilter`                | üïì Before method call        | Filters input collection ‚Üí passes filtered data to method   |
| `@PostAuthorize`            | üïì After method executes     | Checks result object ‚Üí denies access if rule fails          |
| `@PostFilter`               | üïì After method executes     | Filters returned collection before sending back             |
| `@Secured`, `@RolesAllowed` | üïì Before method call        | Simple role check ‚Üí denies if missing role                  |


> 
| **Annotation**                | **When It Runs**              | **Main Purpose**                                                                | **SpEL Support**                    | **Special Variables Available**                               | **Common Expressions**                                                                       | **Example Code**                                                                                                                 | **Result / Behavior**                                                                                          |
| ----------------------------- | ----------------------------- | ------------------------------------------------------------------------------- | ----------------------------------- | ------------------------------------------------------------- | -------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------- |
| **`@PreAuthorize`**           | ‚úÖ **Before method execution** | Checks authorization **before** the method is invoked                           | ‚úîÔ∏è Yes (Spring Expression Language) | `authentication`, `principal`, `#paramName`, etc.             | `hasRole('ADMIN')`, `hasAuthority('DELETE_PRIVILEGE')`, `#id == authentication.principal.id` | `java<br>@PreAuthorize("hasRole('ADMIN') or #username == authentication.name")<br>public User getUser(String username) { ... }`  | Method executes **only if condition is true**; else throws `AccessDeniedException`.                            |
| **`@PostAuthorize`**          | ‚úÖ **After method execution**  | Checks authorization **after** method runs (based on return object)             | ‚úîÔ∏è Yes                              | `authentication`, `principal`, `returnObject`, `#paramName`   | `returnObject.owner == authentication.name`, `hasRole('ADMIN')`                              | `java<br>@PostAuthorize("returnObject.username == authentication.name or hasRole('ADMIN')")<br>public User getProfile() { ... }` | Method executes first; then Spring checks condition on the returned value. If false ‚Üí `AccessDeniedException`. |
| **`@Secured`**                | ‚úÖ **Before method execution** | Restrict access to users with **specific roles** only                           | ‚ùå No SpEL, only role names          | ‚Äî                                                             | `"ROLE_ADMIN"`, `"ROLE_USER"`                                                                | `java<br>@Secured("ROLE_ADMIN")<br>public void deleteUser(Long id) { ... }`                                                      | Simple role-based check; fails if user lacks the listed roles.                                                 |
| **`@RolesAllowed`** (JSR-250) | ‚úÖ **Before method execution** | Similar to `@Secured`, but standard JSR-250 annotation                          | ‚ùå No SpEL                           | ‚Äî                                                             | `"ROLE_ADMIN"`, `"ROLE_MANAGER"`                                                             | `java<br>@RolesAllowed({"ROLE_ADMIN", "ROLE_USER"})<br>public void accessDashboard() { ... }`                                    | Method accessible only to users with one of these roles.                                                       |
| **`@PreFilter`**              | ‚úÖ **Before method execution** | Filters input **collections** before they reach the method                      | ‚úîÔ∏è Yes                              | `filterObject`, `authentication`, `principal`, `#paramName`   | `filterObject.owner == authentication.name`, `hasRole('ADMIN')`                              | `java<br>@PreFilter("filterObject.owner == authentication.name")<br>public void processDocs(List<Document> docs) { ... }`        | Removes any elements from input list that don‚Äôt meet the condition **before** executing the method.            |
| **`@PostFilter`**             | ‚úÖ **After method execution**  | Filters output **collections** after the method executes                        | ‚úîÔ∏è Yes                              | `filterObject`, `authentication`, `principal`, `returnObject` | `filterObject.owner == authentication.name`, `hasRole('ADMIN')`                              | `java<br>@PostFilter("filterObject.owner == authentication.name")<br>public List<Document> getDocs() { ... }`                    | Spring iterates over the returned list and keeps only the elements that satisfy the expression.                |
| **`filterObject`**            | ‚Äî                             | Special variable representing **each element** of a collection during filtering | ‚úîÔ∏è Yes                              | ‚Äî                                                             | `filterObject.owner == authentication.name`                                                  | Used only in `@PreFilter` or `@PostFilter`                                                                                       | Refers to each element being checked in the list/set.                                                          |
| **`returnObject`**            | ‚Äî                             | Represents the **object returned** by the method (for PostAuthorize/PostFilter) | ‚úîÔ∏è Yes                              | ‚Äî                                                             | `returnObject.username == authentication.name`                                               | Used in `@PostAuthorize` / `@PostFilter`                                                                                         | Lets you apply access control on the method‚Äôs result.                                                          |
| **`authentication`**          | ‚Äî                             | The current `Authentication` object from `SecurityContextHolder`                | ‚úîÔ∏è Yes                              | ‚Äî                                                             | `authentication.name`, `authentication.principal.authorities`                                | Used in any SpEL expression                                                                                                      | Gives full info about the logged-in user.                                                                      |
| **`principal`**               | ‚Äî                             | Shortcut for `authentication.principal` (the `UserDetails` object)              | ‚úîÔ∏è Yes                              | ‚Äî                                                             | `principal.username`, `principal.id`                                                         | Used in `@PreAuthorize`, etc.                                                                                                    | Easier access to the user‚Äôs info directly.                                                                     |
